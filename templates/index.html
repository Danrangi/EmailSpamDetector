<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mail Guard</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>

<div id="app-data"
     data-prediction="{{ prediction if prediction else '' }}"
     data-email-text="{{ email_text if email_text else '' }}"
     data-confidence="{{ confidence if confidence else 0 }}"
     data-ham-confidence="{{ ham_confidence if ham_confidence else 0 }}"
     data-spam-confidence="{{ spam_confidence if spam_confidence else 0 }}"
     style="display: none;"></div>

<header class="header">
    <div class="header-brand">
        <div class="header-logo">
            <svg viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                <rect x="2" y="4" width="20" height="16" rx="2"/>
                <path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"/>
            </svg>
        </div>
        <span class="header-title">Mail Guard</span>
        <span class="header-badge">AI Powered</span>
    </div>
</header>

<div class="app-layout">

    <aside class="sidebar">
        <nav class="sidebar-nav">
            <button class="nav-btn active" id="nav-inbox" onclick="switchTab('inbox')">
                <span class="nav-btn-left">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <rect x="2" y="4" width="20" height="16" rx="2"/>
                        <path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"/>
                    </svg>
                    <span class="nav-label">Inbox</span>
                </span>
                <span class="nav-count" id="inbox-count">0</span>
            </button>
            <button class="nav-btn" id="nav-spam" onclick="switchTab('spam')">
                <span class="nav-btn-left">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <circle cx="12" cy="12" r="10"/>
                        <line x1="4.93" y1="4.93" x2="19.07" y2="19.07"/>
                    </svg>
                    <span class="nav-label">Spam</span>
                </span>
                <span class="nav-count spam-count" id="spam-count">0</span>
            </button>
        </nav>

        <div class="sidebar-divider"></div>
        <p class="sidebar-label">Classify</p>
        <button class="nav-btn" id="nav-compose" onclick="switchTab('compose')">
            <span class="nav-btn-left">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M12 20h9"/><path d="M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z"/>
                </svg>
                <span class="nav-label">New Check</span>
            </span>
        </button>
    </aside>

    <div class="message-panel">
        <div class="message-panel-header">
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <h2 class="message-panel-title" id="panel-title">Inbox</h2>
                <button id="clear-list-btn" onclick="clearCurrentList()" style="display:none; background:transparent; border:none; color:#ef4444; font-size:12px; font-weight:600; cursor:pointer;">Clear All</button>
            </div>
            <p class="message-panel-sub" id="panel-sub">0 messages</p>
        </div>
        <div class="message-list" id="message-list">
            <div class="empty-state" id="empty-state">
                <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                    <rect x="2" y="4" width="20" height="16" rx="2"/>
                    <path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"/>
                </svg>
                <p>No messages yet</p>
                <span>Classify an email to get started</span>
            </div>
        </div>
    </div>

    <div class="detail-panel" id="detail-panel">

        <div id="compose-view">
            <form method="POST" action="/">
                <div class="compose-area">
                    <label class="compose-label">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M12 20h9"/><path d="M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z"/>
                        </svg>
                        Paste email content to classify
                    </label>
                    <textarea
                        name="email_text"
                        class="compose-textarea"
                        placeholder="Paste the email text here and click classify to check if it's spam or not..."
                        rows="6"
                        required
                    >{{ email_text if email_text else '' }}</textarea>
                    <div class="compose-actions">
                        <button type="submit" class="btn-classify">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="m22 2-7 20-4-9-9-4z"/><path d="M22 2 11 13"/>
                            </svg>
                            Classify Email
                        </button>
                        <span class="compose-hint">Powered by ML model</span>
                    </div>
                </div>
            </form>

            {% if prediction and prediction != 'unknown' %}
            <div class="result-card {{ prediction }}">
                <div class="result-header">
                    <div class="result-label">
                        <div class="result-icon {{ prediction }}">
                            {% if prediction == 'ham' %}
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M20 6 9 17l-5-5"/>
                            </svg>
                            {% elif prediction == 'spam' %}
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                                <circle cx="12" cy="12" r="10"/><line x1="4.93" y1="4.93" x2="19.07" y2="19.07"/>
                            </svg>
                            {% endif %}
                        </div>
                        <div class="result-text">
                            <h3 class="{{ prediction }}">
                                {% if prediction == 'ham' %}Not Spam â€” Safe
                                {% elif prediction == 'spam' %}Spam Detected
                                {% endif %}
                            </h3>
                            <p class="{{ prediction }}">
                                {% if prediction == 'ham' %}This message looks legitimate
                                {% elif prediction == 'spam' %}This message appears to be spam
                                {% endif %}
                            </p>
                        </div>
                    </div>
                    <div class="result-confidence">
                        <div class="confidence-value {{ prediction }}">{{ confidence }}%</div>
                        <div class="confidence-label">Confidence</div>
                    </div>
                </div>

                <div class="result-details">
                    <div class="confidence-bars">
                        <div class="conf-bar-group">
                            <div class="conf-bar-label">
                                <span class="label-name">Safe</span>
                                <span class="label-val">{{ ham_confidence }}%</span>
                            </div>
                            <div class="conf-bar-track">
                                <div class="conf-bar-fill green" style="width: {{ ham_confidence }}%"></div>
                            </div>
                        </div>
                        <div class="conf-bar-group">
                            <div class="conf-bar-label">
                                <span class="label-name">Spam</span>
                                <span class="label-val">{{ spam_confidence }}%</span>
                            </div>
                            <div class="conf-bar-track">
                                <div class="conf-bar-fill red" style="width: {{ spam_confidence }}%"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            {% endif %}

            {% if not prediction or prediction == 'unknown' %}
            <div class="detail-placeholder">
                <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round">
                    <path d="m22 2-7 20-4-9-9-4z"/><path d="M22 2 11 13"/>
                </svg>
                <p>Paste an email above and hit classify</p>
                <span>The AI will sort it into Inbox or Spam for you</span>
            </div>
            {% endif %}
        </div>

        <div id="email-detail-view" style="display:none; flex-direction:column; flex:1;">
            <div class="detail-email-header-wrap">
                <div>
                    <div class="detail-email-subject" id="detail-subject"></div>
                    <div class="detail-email-meta">
                        <div class="msg-avatar" id="detail-avatar" style="width:28px;height:28px;font-size:10px;"></div>
                        <span class="meta-sender" id="detail-sender"></span>
                        <span class="meta-time" id="detail-time"></span>
                        <span class="meta-badge" id="detail-badge"></span>
                    </div>
                </div>
                <div class="detail-actions" id="detail-actions"></div>
            </div>
            <div class="detail-email" id="detail-body-container">
                <div id="detail-warning"></div>
                <div class="detail-email-body" id="detail-body"></div>
            </div>
        </div>
    </div>
</div>

<script src="{{ url_for('static', filename='main.js') }}"></script>
</body>
</html>